var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},e={},i={},s=t.parcelRequire94c2;null==s&&((s=function(t){if(t in e)return e[t].exports;if(t in i){var s=i[t];delete i[t];var r={id:t,exports:{}};return e[t]=r,s.call(r.exports,r,r.exports),r.exports}var a=Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(t,e){i[t]=e},t.parcelRequire94c2=s),s.register;var r=s("jzE4y"),a=s("k9DLp"),o=s("cWKIK"),l=s("kKihK"),n=s("7K18E");new class{normalizePortraits(t){return t.map(t=>(0,a._)({uuid:(0,l.default)()},t))}onKeyNavigation(t){let e=this.modal._isShown&&this.getPortraitByUuid(this.modalContainer.dataset.uuid),i=this.portraits.findIndex(t=>t.uuid===e.uuid),s=t=>i+this.COLUMN_COUNT.DESKTOP*t,r=t=>i+t,a={ArrowDown:()=>s(1),ArrowUp:()=>s(-1),ArrowLeft:()=>r(-1),ArrowRight:()=>r(1)};if(e&&a[t.key]){let e=a[t.key]();e>=this.portraits.length?e=0:e<0&&(e=this.portraits.length-1),this.setModalPortrait(this.portraits[e])}}getPortraitByUuid(t){return this.portraits.find(e=>e.uuid===t)}render(){return new Promise(t=>{this.container.innerHTML=this.portraits.map(t=>`<img src="${t.url}" data-uuid="${t.uuid}">`).join("\n"),requestAnimationFrame(()=>{this.images=[...this.container.querySelectorAll("img")],t(this.images)})})}attachPortraitEvents(){this.images.forEach(t=>{let e=this.getPortraitByUuid(t.dataset.uuid);t.addEventListener("load",()=>t.classList.add("loaded")),t.addEventListener("click",()=>this.onPortraitClick(e))})}setCssVariables(){this.container.style.setProperty("--Gallery--img-ratio",n.PORTRAIT_HEIGHT/n.PORTRAIT_WIDTH),this.container.style.setProperty("--Gallery--columns-desktop",this.COLUMN_COUNT.DESKTOP),this.container.style.setProperty("--Gallery--columns-mobile",this.COLUMN_COUNT.MOBILE),this.container.style.setProperty("--Gallery--rows-desktop",Math.floor(this.portraits.length/this.COLUMN_COUNT.DESKTOP)),this.container.style.setProperty("--Gallery--rows-mobile",Math.floor(this.portraits.length/this.COLUMN_COUNT.MOBILE))}hideLastUnevenImages(){let t=this.images.length-this.images.length%this.COLUMN_COUNT.DESKTOP,e=this.images.length-this.images.length%this.COLUMN_COUNT.MOBILE;this.images.slice(t).forEach(t=>t.classList.add("ta-hide-desktop")),this.images.slice(e).forEach(t=>t.classList.add("ta-hide-mobile"))}onPortraitClick(t){this.setModalPortrait(t),this.modal.show()}setModalPortrait(t){let{uuid:e,url:i,title:s}=t;this.modalContainer.dataset.uuid=e,this.modalImage.src=i,this.modalTitle.textContent=s}constructor(){(0,r._)(this,"container",void 0),(0,r._)(this,"modalContainer",void 0),(0,r._)(this,"modalImage",void 0),(0,r._)(this,"modalTitle",void 0),(0,r._)(this,"modal",void 0),(0,r._)(this,"images",[]),(0,r._)(this,"portraits",[]),(0,r._)(this,"COLUMN_COUNT",{DESKTOP:4,MOBILE:2}),this.container=document.querySelector(".Gallery__list"),this.modalContainer=document.querySelector(".Gallery__popup"),this.modalImage=document.querySelector(".Gallery__popup-img"),this.modalTitle=document.querySelector(".Gallery__popup-title"),this.modal=new(o&&o.__esModule?o.default:o)(this.modalContainer),this.portraits=this.normalizePortraits(n.GALLERY_PORTRAITS),window.addEventListener("keyup",t=>this.onKeyNavigation(t)),this.render().then(()=>{this.setCssVariables(),this.attachPortraitEvents(),this.hideLastUnevenImages()})}};
//# sourceMappingURL=gallery-ru.d1545e9c.js.map
