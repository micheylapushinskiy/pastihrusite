{"mappings":"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","sources":["<anon>","js/Gallery.js"],"sourcesContent":["\nfunction $parcel$interopDefault(a) {\n  return a && a.__esModule ? a.default : a;\n}\n\n      var $parcel$global =\n        typeof globalThis !== 'undefined'\n          ? globalThis\n          : typeof self !== 'undefined'\n          ? self\n          : typeof window !== 'undefined'\n          ? window\n          : typeof global !== 'undefined'\n          ? global\n          : {};\n  \nvar $parcel$modules = {};\nvar $parcel$inits = {};\n\nvar parcelRequire = $parcel$global[\"parcelRequire94c2\"];\n\nif (parcelRequire == null) {\n  parcelRequire = function(id) {\n    if (id in $parcel$modules) {\n      return $parcel$modules[id].exports;\n    }\n    if (id in $parcel$inits) {\n      var init = $parcel$inits[id];\n      delete $parcel$inits[id];\n      var module = {id: id, exports: {}};\n      $parcel$modules[id] = module;\n      init.call(module.exports, module, module.exports);\n      return module.exports;\n    }\n    var err = new Error(\"Cannot find module '\" + id + \"'\");\n    err.code = 'MODULE_NOT_FOUND';\n    throw err;\n  };\n\n  parcelRequire.register = function register(id, init) {\n    $parcel$inits[id] = init;\n  };\n\n  $parcel$global[\"parcelRequire94c2\"] = parcelRequire;\n}\n\nvar parcelRegister = parcelRequire.register;\n\nvar $jzE4y = parcelRequire(\"jzE4y\");\n\nvar $k9DLp = parcelRequire(\"k9DLp\");\n\nvar $cWKIK = parcelRequire(\"cWKIK\");\n\nvar $kKihK = parcelRequire(\"kKihK\");\n\nvar $7K18E = parcelRequire(\"7K18E\");\nclass $332f5c15ca6d8c9f$export$ace63239d21d36e {\n    normalizePortraits(portraitsRaw) {\n        return portraitsRaw.map((portrait)=>{\n            return (0, $k9DLp._)({\n                uuid: (0, $kKihK.default)()\n            }, portrait);\n        });\n    }\n    onKeyNavigation(e) {\n        const currentlyOpenPortrait = this.modal._isShown && this.getPortraitByUuid(this.modalContainer.dataset.uuid);\n        const currentIndex = this.portraits.findIndex((portrait)=>portrait.uuid === currentlyOpenPortrait.uuid);\n        const getNextVerticalIndex = (delta)=>{\n            return currentIndex + this.COLUMN_COUNT.DESKTOP * delta;\n        };\n        const getNextHorizontalIndex = (delta)=>{\n            return currentIndex + delta;\n        };\n        const getNextIndex = {\n            ArrowDown: ()=>getNextVerticalIndex(1),\n            ArrowUp: ()=>getNextVerticalIndex(-1),\n            ArrowLeft: ()=>getNextHorizontalIndex(-1),\n            ArrowRight: ()=>getNextHorizontalIndex(1)\n        };\n        if (currentlyOpenPortrait && getNextIndex[e.key]) {\n            let nextIndex = getNextIndex[e.key]();\n            if (nextIndex >= this.portraits.length) nextIndex = 0;\n            else if (nextIndex < 0) nextIndex = this.portraits.length - 1;\n            this.setModalPortrait(this.portraits[nextIndex]);\n        }\n    }\n    getPortraitByUuid(uuid) {\n        return this.portraits.find((portrait)=>portrait.uuid === uuid);\n    }\n    render() {\n        return new Promise((resolve)=>{\n            this.container.innerHTML = this.portraits.map((portrait)=>`<img src=\"${portrait.url}\" data-uuid=\"${portrait.uuid}\">`).join('\\n');\n            requestAnimationFrame(()=>{\n                this.images = [\n                    ...this.container.querySelectorAll('img')\n                ];\n                resolve(this.images);\n            });\n        });\n    }\n    attachPortraitEvents() {\n        this.images.forEach((img)=>{\n            const portrait = this.getPortraitByUuid(img.dataset.uuid);\n            img.addEventListener('load', ()=>img.classList.add('loaded'));\n            img.addEventListener('click', ()=>this.onPortraitClick(portrait));\n        });\n    }\n    setCssVariables() {\n        this.container.style.setProperty('--Gallery--img-ratio', (0, $7K18E.PORTRAIT_HEIGHT) / (0, $7K18E.PORTRAIT_WIDTH));\n        this.container.style.setProperty('--Gallery--columns-desktop', this.COLUMN_COUNT.DESKTOP);\n        this.container.style.setProperty('--Gallery--columns-mobile', this.COLUMN_COUNT.MOBILE);\n        this.container.style.setProperty('--Gallery--rows-desktop', Math.floor(this.portraits.length / this.COLUMN_COUNT.DESKTOP));\n        this.container.style.setProperty('--Gallery--rows-mobile', Math.floor(this.portraits.length / this.COLUMN_COUNT.MOBILE));\n    }\n    hideLastUnevenImages() {\n        const displayedCountDesktop = this.images.length - this.images.length % this.COLUMN_COUNT.DESKTOP;\n        const displayedCountMobile = this.images.length - this.images.length % this.COLUMN_COUNT.MOBILE;\n        this.images.slice(displayedCountDesktop).forEach((img)=>img.classList.add('ta-hide-desktop'));\n        this.images.slice(displayedCountMobile).forEach((img)=>img.classList.add('ta-hide-mobile'));\n    }\n    onPortraitClick(portrait) {\n        this.setModalPortrait(portrait);\n        this.modal.show();\n    }\n    setModalPortrait(portrait) {\n        const { uuid: uuid, url: url, title: title } = portrait;\n        this.modalContainer.dataset.uuid = uuid;\n        this.modalImage.src = url;\n        this.modalTitle.textContent = title;\n    }\n    constructor(){\n        (0, $jzE4y._)(this, \"container\", void 0);\n        (0, $jzE4y._)(this, \"modalContainer\", void 0);\n        (0, $jzE4y._)(this, \"modalImage\", void 0);\n        (0, $jzE4y._)(this, \"modalTitle\", void 0);\n        (0, $jzE4y._)(this, \"modal\", void 0);\n        (0, $jzE4y._)(this, \"images\", []);\n        (0, $jzE4y._)(this, \"portraits\", []);\n        (0, $jzE4y._)(this, \"COLUMN_COUNT\", {\n            DESKTOP: 4,\n            MOBILE: 2\n        });\n        this.container = document.querySelector('.Gallery__list');\n        this.modalContainer = document.querySelector('.Gallery__popup');\n        this.modalImage = document.querySelector('.Gallery__popup-img');\n        this.modalTitle = document.querySelector('.Gallery__popup-title');\n        this.modal = new (0, (/*@__PURE__*/$parcel$interopDefault($cWKIK)))(this.modalContainer);\n        this.portraits = this.normalizePortraits((0, $7K18E.GALLERY_PORTRAITS));\n        window.addEventListener('keyup', (e)=>this.onKeyNavigation(e));\n        this.render().then(()=>{\n            this.setCssVariables();\n            this.attachPortraitEvents();\n            this.hideLastUnevenImages();\n        });\n    }\n}\nnew $332f5c15ca6d8c9f$export$ace63239d21d36e();\n\n\n//# sourceMappingURL=gallery-ru.d1545e9c.js.map\n","import Modal from 'bootstrap/js/dist/modal';\nimport { v4 as uuidv4 } from 'uuid';\nimport { GALLERY_PORTRAITS, PORTRAIT_WIDTH, PORTRAIT_HEIGHT } from './Config';\n\nexport class Gallery {\n\n  container;\n  modalContainer;\n  modalImage;\n  modalTitle;\n  modal;\n\n  images = [];\n  portraits = [];\n\n  COLUMN_COUNT = {\n    DESKTOP: 4,\n    MOBILE: 2,\n  };\n\n  constructor(){\n    this.container = document.querySelector('.Gallery__list');\n\n    this.modalContainer = document.querySelector('.Gallery__popup');\n    this.modalImage = document.querySelector('.Gallery__popup-img');\n    this.modalTitle = document.querySelector('.Gallery__popup-title');\n    this.modal = new Modal(this.modalContainer);\n\n    this.portraits = this.normalizePortraits(GALLERY_PORTRAITS);\n\n    window.addEventListener('keyup', (e) => this.onKeyNavigation(e));\n\n    this.render().then(() => {\n      this.setCssVariables();\n      this.attachPortraitEvents();\n      this.hideLastUnevenImages();\n    });\n  }\n\n  normalizePortraits(portraitsRaw){\n    return portraitsRaw.map(portrait => {\n      return {\n        uuid: uuidv4(),\n        ...portrait,\n      };\n    });\n  }\n\n  onKeyNavigation(e){\n    const currentlyOpenPortrait = this.modal._isShown && this.getPortraitByUuid(this.modalContainer.dataset.uuid);\n    const currentIndex = this.portraits.findIndex(portrait => portrait.uuid === currentlyOpenPortrait.uuid);\n\n    const getNextVerticalIndex = (delta) => {\n      return currentIndex + (this.COLUMN_COUNT.DESKTOP * delta);\n    };\n    const getNextHorizontalIndex = (delta) => {\n      return currentIndex + delta;\n    };\n    const getNextIndex = {\n      ArrowDown: () => getNextVerticalIndex(1),\n      ArrowUp: () => getNextVerticalIndex(-1),\n      ArrowLeft: () => getNextHorizontalIndex(-1),\n      ArrowRight: () => getNextHorizontalIndex(1),\n    };\n\n    if (currentlyOpenPortrait && getNextIndex[e.key]) {\n      let nextIndex = getNextIndex[e.key]();\n\n      if (nextIndex >= this.portraits.length) {\n        nextIndex = 0;\n      }\n      else if (nextIndex < 0) {\n        nextIndex = this.portraits.length - 1;\n      }\n      this.setModalPortrait(this.portraits[nextIndex]);\n    }\n  }\n\n  getPortraitByUuid(uuid){\n    return this.portraits.find(portrait => portrait.uuid === uuid);\n  }\n\n  render(){\n    return new Promise(resolve => {\n      this.container.innerHTML = this.portraits\n        .map(portrait => `<img src=\"${portrait.url}\" data-uuid=\"${portrait.uuid}\">`)\n        .join('\\n');\n\n      requestAnimationFrame(() => {\n        this.images = [...this.container.querySelectorAll('img')];\n        resolve(this.images);\n      });\n    });\n  }\n\n  attachPortraitEvents(){\n    this.images.forEach(img => {\n      const portrait = this.getPortraitByUuid(img.dataset.uuid);\n      img.addEventListener('load', () => img.classList.add('loaded'));\n      img.addEventListener('click', () => this.onPortraitClick(portrait));\n    });\n  }\n\n  setCssVariables(){\n    this.container.style.setProperty('--Gallery--img-ratio', PORTRAIT_HEIGHT / PORTRAIT_WIDTH);\n    this.container.style.setProperty('--Gallery--columns-desktop', this.COLUMN_COUNT.DESKTOP);\n    this.container.style.setProperty('--Gallery--columns-mobile', this.COLUMN_COUNT.MOBILE);\n\n    this.container.style.setProperty('--Gallery--rows-desktop', Math.floor(this.portraits.length / this.COLUMN_COUNT.DESKTOP));\n    this.container.style.setProperty('--Gallery--rows-mobile', Math.floor(this.portraits.length / this.COLUMN_COUNT.MOBILE));\n  }\n\n  hideLastUnevenImages(){\n    const displayedCountDesktop = this.images.length - (this.images.length % this.COLUMN_COUNT.DESKTOP);\n    const displayedCountMobile = this.images.length - (this.images.length % this.COLUMN_COUNT.MOBILE);\n\n    this.images.slice(displayedCountDesktop).forEach(img => img.classList.add('ta-hide-desktop'));\n    this.images.slice(displayedCountMobile).forEach(img => img.classList.add('ta-hide-mobile'));\n  }\n\n  onPortraitClick(portrait){\n    this.setModalPortrait(portrait);\n    this.modal.show();\n  }\n\n  setModalPortrait(portrait){\n    const { uuid, url, title } = portrait;\n    this.modalContainer.dataset.uuid = uuid;\n    this.modalImage.src = url;\n    this.modalTitle.textContent = title;\n  }\n}\n\nnew Gallery();\n"],"names":["$parcel$global","globalThis","self","window","global","$parcel$modules","$parcel$inits","parcelRequire","id","exports","init","module","call","err","Error","code","register","$jzE4y","$k9DLp","$cWKIK","$kKihK","$7K18E","normalizePortraits","portraitsRaw","map","portrait","_","uuid","default","onKeyNavigation","e","currentlyOpenPortrait","modal","_isShown","getPortraitByUuid","modalContainer","dataset","currentIndex","portraits","findIndex","getNextVerticalIndex","delta","COLUMN_COUNT","DESKTOP","getNextHorizontalIndex","getNextIndex","ArrowDown","ArrowUp","ArrowLeft","ArrowRight","key","nextIndex","length","setModalPortrait","find","render","Promise","resolve","container","innerHTML","url","join","requestAnimationFrame","images","querySelectorAll","attachPortraitEvents","forEach","img","addEventListener","classList","add","onPortraitClick","setCssVariables","style","setProperty","PORTRAIT_HEIGHT","PORTRAIT_WIDTH","MOBILE","Math","floor","hideLastUnevenImages","displayedCountDesktop","displayedCountMobile","slice","show","title","modalImage","src","modalTitle","textContent","constructor","document","querySelector","a","__esModule","GALLERY_PORTRAITS","then"],"version":3,"file":"gallery-ru.d1545e9c.js.map"}